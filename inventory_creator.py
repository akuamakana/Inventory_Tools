from openpyxl import Workbook, load_workbook
from computer_info import Computer
import datetime

## scan text: 10.148.68.1-254, 10.148.70.1-254, 10.148.72.1-254, 10.148.74.1-254, 10.148.94.1-254, 10.148.90.1-254, 10.148.24.1-254

ipAddresses = """10.148.74.136
10.148.72.91
10.148.68.217
10.148.68.206
10.148.68.167
10.148.68.62
10.148.74.167
10.148.24.44
10.148.70.157
10.148.24.48
10.148.70.123
10.148.74.77
10.148.74.205
10.148.68.242
10.148.68.85
10.148.68.127
10.148.68.65
10.148.68.245
10.148.68.80
10.148.24.70
10.148.68.74
10.148.68.174
10.148.90.150
10.148.90.194
10.148.70.79
10.148.70.213
10.148.70.111
10.148.70.184
10.148.70.225
10.148.72.192
10.148.70.188
10.148.70.148
10.148.70.205
10.148.70.138
10.148.70.101
10.148.70.109
10.148.24.208
10.148.90.145
10.148.70.163
10.148.70.83
10.148.70.94
10.148.70.39
10.148.94.200
10.148.94.212
10.148.90.175
10.148.70.104
10.148.70.179
10.148.70.198
10.148.70.155
10.148.70.53
10.148.74.241
10.148.70.114
10.148.70.177
10.148.70.77
10.148.70.131
10.148.70.129
10.148.70.98
10.148.70.246
10.148.70.244
10.148.70.88
10.148.70.122
10.148.70.245
10.148.70.235
10.148.70.237
10.148.70.206
10.148.70.196
10.148.70.89
10.148.70.126
10.148.72.92
10.148.70.175
10.148.68.149
10.148.70.106
10.148.70.80
10.148.70.220
10.148.24.41
10.148.24.115
10.148.24.77
10.148.24.59
10.148.24.71
10.148.24.170
10.148.24.117
10.148.70.73
10.148.70.43
10.148.74.174
10.148.24.37
10.148.68.160
10.148.24.38
10.148.24.139
10.148.24.40
10.148.70.214
10.148.24.160
10.148.24.53
10.148.70.218
10.148.74.116
10.148.72.60
10.148.24.46
10.148.72.164
10.148.74.204
10.148.24.244
10.148.72.246
10.148.72.229
10.148.72.98
10.148.24.185
10.148.74.187
10.148.74.233
10.148.72.82
10.148.72.156
10.148.72.158
10.148.72.244
10.148.72.114
10.148.72.199
10.148.72.68
10.148.72.81
10.148.72.241
10.148.72.215
10.148.72.56
10.148.74.47
10.148.72.109
10.148.74.126
10.148.74.210
10.148.74.197
10.148.74.155
10.148.74.50
10.148.74.61
10.148.74.131
10.148.70.158
10.148.74.188
10.148.74.224
10.148.74.229
10.148.74.98
10.148.74.199
10.148.74.70
10.148.74.91
10.148.70.185
10.148.74.92
10.148.70.96
10.148.74.113
10.148.74.208
10.148.72.232
10.148.74.207
10.148.74.66
10.148.74.175
10.148.74.143
10.148.74.103
10.148.74.81
10.148.24.76
10.148.24.101
10.148.24.65
10.148.24.121""".split()


def writeToExcel(ipAddresses):
    sheetName = str(datetime.date.today())
    headers = [
        "Location",
        "Citrix Number",
        "Serial Number",
        "Name",
        "OS",
        "Model",
        "IP",
        "Logged On",
        "Username",
    ]

    try:
        wb = load_workbook("pcInventory.xlsx")
    except FileNotFoundError:
        wb = Workbook()
    wb.create_sheet(sheetName, -1)
    ws = wb[sheetName]
    ws.append(headers)

    for ipAddress in ipAddresses:
        pcInfo = Computer(ipAddress)
        writeToRow = pcInfo.allInfo
        ws.append(writeToRow)

    wb.save("pcInventory.xlsx")


writeToExcel(ipAddresses)
